
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Total alkalinity from titration data.">
      
      
        <meta name="author" content="Matthew P. Humphreys">
      
      
        <link rel="canonical" href="https://mvdh.xyz/calkulate/methods/">
      
      
        <link rel="prev" href="../metadata/">
      
      
        <link rel="next" href="../plot/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Dataset methods - Calkulate</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="cyan" data-md-color-accent="yellow">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dataset-methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Calkulate" class="md-header__button md-logo" aria-label="Calkulate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Calkulate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dataset methods
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mvdh7/calkulate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mvdh7/calkulate
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Calkulate" class="md-nav__button md-logo" aria-label="Calkulate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Calkulate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mvdh7/calkulate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mvdh7/calkulate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata contents and format
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Dataset methods
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Dataset methods
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do-everything-at-once-with-calkulate" class="md-nav__link">
    <span class="md-ellipsis">
      Do everything at once with calkulate...
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#or-do-it-step-by-step" class="md-nav__link">
    <span class="md-ellipsis">
      ... or do it step-by-step
    </span>
  </a>
  
    <nav class="md-nav" aria-label="... or do it step-by-step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calibrate-titrant-molinity" class="md-nav__link">
    <span class="md-ellipsis">
      Calibrate titrant molinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve-samples-for-alkalinity" class="md-nav__link">
    <span class="md-ellipsis">
      Solve samples for alkalinity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-break-it-up" class="md-nav__link">
    <span class="md-ellipsis">
      Why break it up?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualisation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../validate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Version history
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do-everything-at-once-with-calkulate" class="md-nav__link">
    <span class="md-ellipsis">
      Do everything at once with calkulate...
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#or-do-it-step-by-step" class="md-nav__link">
    <span class="md-ellipsis">
      ... or do it step-by-step
    </span>
  </a>
  
    <nav class="md-nav" aria-label="... or do it step-by-step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calibrate-titrant-molinity" class="md-nav__link">
    <span class="md-ellipsis">
      Calibrate titrant molinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solve-samples-for-alkalinity" class="md-nav__link">
    <span class="md-ellipsis">
      Solve samples for alkalinity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-break-it-up" class="md-nav__link">
    <span class="md-ellipsis">
      Why break it up?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="dataset-methods">Dataset methods<a class="headerlink" href="#dataset-methods" title="Permanent link">&para;</a></h1>
<p>Once you have <a href="../read/#titration-metadata-dataset">imported your Dataset</a> (as <code>ds</code> in the example code below) and made sure it has <a href="../metadata/#dataset-column-names">the necessary columns, named correctly</a>, you can use a series of different functions or methods to calibrate the titrant and solve the samples for alkalinity.</p>
<div class="admonition question">
<p class="admonition-title">Methods or functions?</p>
<p>All the methods mentioned here operate on the Dataset in-place, but are also available as functions at the top-level, in case you prefer that syntax.  The method approach is recommended:</p>
<div class="highlight"><pre><span></span><code><span class="n">ds</span><span class="o">.</span><span class="n">calkulate</span><span class="p">()</span>
</code></pre></div>
<p>But you could also achieve the same thing with the function approach, if you prefer:</p>
<div class="highlight"><pre><span></span><code>ds = calk.calkulate(ds)
</code></pre></div>
</div>
<h2 id="do-everything-at-once-with-calkulate">Do everything at once with <code>calkulate</code>...<a class="headerlink" href="#do-everything-at-once-with-calkulate" title="Permanent link">&para;</a></h2>
<p>The method <code>calkulate</code> does <em>everything:</em></p>
<div class="highlight"><pre><span></span><code><span class="n">ds</span><span class="o">.</span><span class="n">calkulate</span><span class="p">()</span>
</code></pre></div>
<h2 id="or-do-it-step-by-step">... or do it step-by-step<a class="headerlink" href="#or-do-it-step-by-step" title="Permanent link">&para;</a></h2>
<p>But what do we mean by <em>everything?</em>  This includes two main steps: calibration and solving.  You can also run yourself separately if you prefer.</p>
<h3 id="calibrate-titrant-molinity">Calibrate titrant molinity<a class="headerlink" href="#calibrate-titrant-molinity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">ds</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</code></pre></div>
<p>For each titration (i.e. row in the Dataset) that has an <a href="../metadata/#recommended-columns"><code>alkalinity_certified</code> value</a>, this method determines the titrant molinity (in mol/kg-sol) that is required for the titration to return its certified alkalinity value.  This is stored in a new column in the Dataset called <code>titrant_molinity_here</code>.</p>
<p>Then, the <code>titrant_molinity_here</code> values are averaged — <a href="../metadata/#recommended-columns">by <code>analysis_batch</code></a> if provided, or over the entire Dataset if not — and stored in a new column called <code>titrant_molinity</code>.</p>
<h3 id="solve-samples-for-alkalinity">Solve samples for alkalinity<a class="headerlink" href="#solve-samples-for-alkalinity" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">ds</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</code></pre></div>
<p>For each titration (i.e. row in the Dataset) that has an <code>titrant_molinity</code> value (e.g. as generated by <code>ds.calibrate()</code> above), this method determines its total alkalinity in µmol/kg-sol.  The results are stored in a new column in the Dataset called <code>alkalinity</code>.</p>
<h2 id="why-break-it-up">Why break it up?<a class="headerlink" href="#why-break-it-up" title="Permanent link">&para;</a></h2>
<p>You may wish to use the step-by-step approach if you need to do any intermediate processing.  For example, if the approach of taking the mean titrant molinity for each analysis batch is not appropriate to your dataset, you could do:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">calkulate</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">calk</span>

<span class="c1"># Import data and calibrate individual titrant molinities</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">calk</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;path/to/metadata_file.xlsx&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>

<span class="c1"># Update the titrant molinity values to whatever they should be</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;titrant_molinity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Solve for alkalinity</span>
<span class="n">ds</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</code></pre></div>
<p>Alternatively, if your metadata is coming from a VINDTA dbs file, you may need to add extra columns to it before processing:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Import metadata</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">calk</span><span class="o">.</span><span class="n">read_dbs</span><span class="p">(</span><span class="s2">&quot;path/to/metadata_file.dbs&quot;</span><span class="p">)</span>

<span class="c1"># Add extra columns</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysis_batch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;alkalinity_certified&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1"># etc.</span>

<span class="c1"># Calkulate!</span>
<span class="n">ds</span><span class="o">.</span><span class="n">calkulate</span><span class="p">()</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019—2025  Matthew P. Humphreys  (GNU GPLv3)
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>